<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备维修报价查询 - 专业快速上门维修</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .quote-card { transition: all 0.3s ease; }
        .quote-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); }
        .step-item { transition: all 0.3s ease; }
        .empty-tip { text-align: center; padding: 20px; color: #6b7280; font-size: 14px; }
        .debug-info { font-size: 12px; color: #9ca3af; margin-top: 10px; text-align: center; }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800 min-h-screen">
    <!-- 顶部导航 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-tools text-blue-600 text-2xl"></i>
                <h1 class="text-xl font-bold text-blue-600">设备维修报价查询</h1>
            </div>
            <div class="text-sm text-gray-500">
                <i class="fa-solid fa-phone mr-1"></i>
                <span class="font-medium text-gray-700">400-123-4567</span>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 py-8 max-w-3xl">
        <!-- 动态步骤指示器（3步/4步自适应） -->
        <div class="flex justify-between items-center mb-8" id="stepIndicator">
            <!-- 步骤1：选择设备类型（固定） -->
            <div class="flex flex-col items-center step-item" data-step="1">
                <div class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold">1</div>
                <span class="mt-2 text-sm font-medium">选择设备</span>
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2">
                <div class="h-full bg-blue-600 step-progress" style="width: 0%"></div>
            </div>
            <!-- 步骤2：动态内容（品牌/子分类/故障） -->
            <div class="flex flex-col items-center step-item" data-step="2">
                <div class="w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold">2</div>
                <span class="mt-2 text-sm font-medium text-gray-500" id="step2Text">选择分类</span>
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2" id="step2Divider" style="display: none">
                <div class="h-full bg-blue-600 step-progress-2" style="width: 0%"></div>
            </div>
            <!-- 步骤3：动态内容（故障/报价） -->
            <div class="flex flex-col items-center step-item" data-step="3">
                <div class="w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold">3</div>
                <span class="mt-2 text-sm font-medium text-gray-500" id="step3Text">选择故障</span>
            </div>
            <div class="flex-1 h-1 bg-gray-200 mx-2" id="step3Divider" style="display: none">
                <div class="h-full bg-blue-600 step-progress-3" style="width: 0%"></div>
            </div>
            <!-- 步骤4：查看报价（仅手机/笔记本需要） -->
            <div class="flex flex-col items-center step-item" data-step="4" style="display: none">
                <div class="w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold">4</div>
                <span class="mt-2 text-sm font-medium text-gray-500">查看报价</span>
            </div>
        </div>

        <!-- 步骤1：选择设备类型（固定） -->
        <section id="step1" class="fade-in block">
            <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fa-solid fa-device-hub text-blue-600 mr-2"></i>选择设备类型
                </h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" id="deviceTypeList">
                    <!-- 设备类型动态生成 -->
                </div>
            </div>
        </section>

        <!-- 步骤2：分支内容（手机→品牌，笔记本→子分类，其他→故障） -->
        <section id="step2" class="fade-in hidden">
            <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center" id="step2Title">
                    <i class="fa-solid fa-list text-blue-600 mr-2"></i>
                    <span>选择分类</span>
                    <span class="ml-2 text-sm font-normal text-gray-500" id="step2Subtitle"></span>
                </h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" id="step2Content">
                    <!-- 动态生成品牌/子分类/故障列表 -->
                </div>
                <div id="step2Debug" class="debug-info"></div> <!-- 调试信息 -->
                <button id="backToStep1" class="mt-6 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-arrow-left mr-1"></i>返回
                </button>
            </div>
        </section>

        <!-- 步骤3：分支内容（手机/笔记本→故障，其他→报价） -->
        <section id="step3" class="fade-in hidden">
            <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center" id="step3Title">
                    <i class="fa-solid fa-wrench text-blue-600 mr-2"></i>
                    <span>选择故障类型</span>
                    <span class="ml-2 text-sm font-normal text-gray-500" id="step3Subtitle"></span>
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" id="faultList">
                    <!-- 故障列表动态生成 -->
                </div>
                <div id="step3Debug" class="debug-info"></div> <!-- 调试信息 -->
                <button id="backToStep2" class="mt-6 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                    <i class="fa-solid fa-arrow-left mr-1"></i>返回
                </button>
            </div>
        </section>

        <!-- 步骤4：查看报价（固定） -->
        <section id="step4" class="fade-in hidden">
            <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <i class="fa-solid fa-tag text-blue-600 mr-2"></i>维修报价详情
                </h2>
                <div class="border-b pb-4 mb-4" id="quoteInfo">
                    <!-- 报价信息动态生成 -->
                </div>
                <div class="quote-card bg-blue-50 rounded-lg p-4 mb-6">
                    <div class="text-center">
                        <p class="text-sm text-gray-600 mb-1">参考报价</p>
                        <p class="text-3xl font-bold text-blue-600" id="quotePrice">¥0</p>
                        <p class="text-xs text-gray-500 mt-2">价格仅供参考，实际费用以检测后为准</p>
                    </div>
                </div>
                <div class="space-y-4 mb-6">
                    <div class="flex items-start">
                        <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-2"></i>
                        <p class="text-sm text-gray-600">免费上门检测，检测后报价不满意可拒绝维修</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-2"></i>
                        <p class="text-sm text-gray-600">维修后享受90天质保，质保期内同一故障免费返修</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fa-solid fa-check-circle text-green-500 mt-1 mr-2"></i>
                        <p class="text-sm text-gray-600">支持微信、支付宝付款，维修完成后再付款</p>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-4">
                    <button id="backToStep3" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                        <i class="fa-solid fa-arrow-left mr-1"></i>重新选择
                    </button>
                    <a href="tel:4001234567" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center">
                        <i class="fa-solid fa-phone mr-2"></i>立即预约维修
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- 底部信息 -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center text-sm">
            <p class="mb-2">© 2025 设备维修服务中心 - 专业手机、电脑、存储设备维修服务</p>
            <p class="text-gray-400">地址：XX市XX区XX路XX号 | 服务时间：9:00-21:00（全年无休）</p>
        </div>
    </footer>

    <script>
        // 全局状态变量
        let globalData = {
            repairData: [],
            selectedDevice: '', // 选中的设备类型（手机/笔记本/台式机/硬盘/U盘）
            selectedBrand: '', // 选中的手机品牌（仅手机）
            selectedLaptopType: '', // 选中的笔记本子分类（仅笔记本）
            selectedFault: {} // 选中的故障信息
        };

        // DOM元素缓存
        const dom = {
            step1: document.getElementById('step1'),
            step2: document.getElementById('step2'),
            step3: document.getElementById('step3'),
            step4: document.getElementById('step4'),
            step2Text: document.getElementById('step2Text'),
            step3Text: document.getElementById('step3Text'),
            step2Divider: document.getElementById('step2Divider'),
            step3Divider: document.getElementById('step3Divider'),
            step2Title: document.getElementById('step2Title'),
            step2Subtitle: document.getElementById('step2Subtitle'),
            step3Title: document.getElementById('step3Title'),
            step3Subtitle: document.getElementById('step3Subtitle'),
            deviceTypeList: document.getElementById('deviceTypeList'),
            step2Content: document.getElementById('step2Content'),
            faultList: document.getElementById('faultList'),
            quoteInfo: document.getElementById('quoteInfo'),
            quotePrice: document.getElementById('quotePrice'),
            backToStep1: document.getElementById('backToStep1'),
            backToStep2: document.getElementById('backToStep2'),
            backToStep3: document.getElementById('backToStep3'),
            step2Debug: document.getElementById('step2Debug'),
            step3Debug: document.getElementById('step3Debug')
        };

        // 设备类型配置（含图标）
        const deviceConfig = {
            '手机': { icon: 'fa-mobile-screen-button', hasBrand: true, hasSubtype: false },
            '笔记本': { icon: 'fa-laptop', hasBrand: false, hasSubtype: true },
            '台式机': { icon: 'fa-desktop', hasBrand: false, hasSubtype: false },
            '硬盘': { icon: 'fa-hdd', hasBrand: false, hasSubtype: false },
            'U盘': { icon: 'fa-usb', hasBrand: false, hasSubtype: false }
        };

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 加载JSON数据
            loadRepairData();
            // 绑定返回按钮事件
            bindBackEvents();
        });

        // 加载维修价格数据（分离式JSON）
        function loadRepairData() {
            fetch('prices.json')
                .then(response => {
                    if (!response.ok) throw new Error('数据加载失败');
                    return response.json();
                })
                .then(data => {
                    globalData.repairData = data;
                    renderDeviceTypeList(); // 渲染设备类型列表
                })
                .catch(error => {
                    console.error('错误：', error);
                    alert('报价数据加载失败，请确认：1.prices.json与index.html在同一文件夹 2.文件格式正确 3.使用本地服务器打开');
                });
        }

        // 渲染设备类型列表
        function renderDeviceTypeList() {
            dom.deviceTypeList.innerHTML = '';
            Object.keys(deviceConfig).forEach(device => {
                const { icon } = deviceConfig[device];
                const item = document.createElement('div');
                item.className = 'bg-white border border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition';
                item.innerHTML = `
                    <i class="fa-solid ${icon} text-blue-600 text-2xl mb-2"></i>
                    <p class="font-medium">${device}</p>
                `;
                item.addEventListener('click', () => handleDeviceSelect(device));
                dom.deviceTypeList.appendChild(item);
            });
        }

        // 处理设备类型选择
        function handleDeviceSelect(device) {
            globalData.selectedDevice = device;
            const { hasBrand, hasSubtype } = deviceConfig[device];

            // 重置后续状态
            globalData.selectedBrand = '';
            globalData.selectedLaptopType = '';
            globalData.selectedFault = {};

            // 配置步骤指示器
            if (hasBrand || hasSubtype) {
                // 手机/笔记本：4步流程
                document.querySelector('[data-step="4"]').style.display = 'flex';
                dom.step2Divider.style.display = 'block';
                dom.step3Divider.style.display = 'block';
                dom.step2Text.textContent = hasBrand ? '选择品牌' : '选择子分类';
                dom.step3Text.textContent = '选择故障';

                // 渲染步骤2内容
                if (hasBrand) {
                    dom.step2Title.querySelector('span').textContent = '选择手机品牌';
                    renderPhoneBrandList();
                } else {
                    dom.step2Title.querySelector('span').textContent = '选择笔记本类型';
                    renderLaptopSubtypeList();
                }
            } else {
                // 台式机/硬盘/U盘：3步流程
                document.querySelector('[data-step="4"]').style.display = 'none';
                dom.step2Divider.style.display = 'none';
                dom.step3Divider.style.display = 'none';
                dom.step2Text.textContent = '选择故障';
                dom.step3Text.textContent = '查看报价';

                // 渲染步骤2内容（故障列表）
                dom.step2Title.querySelector('span').textContent = '选择故障类型';
                dom.step2Subtitle.textContent = `（${device}）`;
                renderFaultList({
                    deviceType: device,
                    filterKey: null,
                    filterValue: null,
                    targetContainer: dom.step2Content,
                    debugEl: dom.step2Debug
                });
            }

            // 更新步骤样式和显示状态
            updateStepStatus(1, 2);
            dom.step1.classList.add('hidden');
            dom.step2.classList.remove('hidden');
        }

        // 渲染手机品牌列表（步骤2）
        function renderPhoneBrandList() {
            dom.step2Content.innerHTML = '';
            dom.step2Subtitle.textContent = '';

            // 过滤手机数据
            const phoneData = globalData.repairData.filter(item => item.deviceType === '手机');
            const brands = [...new Set(phoneData.map(item => item.brand))];

            // 调试信息
            dom.step2Debug.textContent = `共加载${phoneData.length}条手机数据，${brands.length}个品牌`;

            // 无品牌数据提示
            if (brands.length === 0) {
                dom.step2Content.innerHTML = `<div class="empty-tip col-span-full"><i class="fa-solid fa-info-circle mr-1"></i>暂无手机品牌数据</div>`;
                return;
            }

            // 品牌图标配置
            const brandIcons = {
                '苹果': 'fa-apple',
                '华为': 'fa-huawei',
                '小米': 'fa-mobile-alt',
                'OPPO': 'fa-mobile',
                'vivo': 'fa-mobile',
                '三星': 'fa-samsung',
                '荣耀': 'fa-star',
                '魅族': 'fa-moon',
                '一加': 'fa-plus',
                'iPad': 'fa-tablet-alt'
            };

            brands.forEach(brand => {
                // 统计该品牌的故障数量（显示在品牌下方）
                const faultCount = phoneData.filter(item => item.brand === brand).length;
                const icon = brandIcons[brand] || 'fa-mobile-screen';
                const item = document.createElement('div');
                item.className = 'bg-white border border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition';
                item.innerHTML = `
                    <i class="fa-solid ${icon} text-blue-600 text-2xl mb-2"></i>
                    <p class="font-medium">${brand}</p>
                    <p class="text-xs text-gray-500 mt-1">${faultCount}个故障</p>
                `;
                item.addEventListener('click', () => handleBrandSelect(brand));
                dom.step2Content.appendChild(item);
            });
        }

        // 渲染笔记本子分类列表（步骤2）
        function renderLaptopSubtypeList() {
            dom.step2Content.innerHTML = '';
            dom.step2Subtitle.textContent = '';

            // 过滤笔记本数据
            const laptopData = globalData.repairData.filter(item => item.deviceType === '笔记本');
            const subtypes = [...new Set(laptopData.map(item => item.laptopType))];

            // 调试信息
            dom.step2Debug.textContent = `共加载${laptopData.length}条笔记本数据，${subtypes.length}个类型`;

            // 无子分类数据提示
            if (subtypes.length === 0) {
                dom.step2Content.innerHTML = `<div class="empty-tip col-span-full"><i class="fa-solid fa-info-circle mr-1"></i>暂无笔记本类型数据</div>`;
                return;
            }

            const subtypeIcons = { '办公本': 'fa-briefcase', '游戏本': 'fa-gamepad' };

            subtypes.forEach(type => {
                // 统计该类型的故障数量
                const faultCount = laptopData.filter(item => item.laptopType === type).length;
                const icon = subtypeIcons[type] || 'fa-laptop';
                const item = document.createElement('div');
                item.className = 'bg-white border border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition';
                item.innerHTML = `
                    <i class="fa-solid ${icon} text-blue-600 text-2xl mb-2"></i>
                    <p class="font-medium">${type}</p>
                    <p class="text-xs text-gray-500 mt-1">${faultCount}个故障</p>
                `;
                item.addEventListener('click', () => handleLaptopSubtypeSelect(type));
                dom.step2Content.appendChild(item);
            });
        }

        // 处理手机品牌选择（步骤2→步骤3）
        function handleBrandSelect(brand) {
            globalData.selectedBrand = brand;
            dom.step3Subtitle.textContent = `（手机 - ${brand}）`;

            // 渲染故障列表：设备类型=手机 + 品牌=选中品牌
            renderFaultList({
                deviceType: '手机',
                filterKey: 'brand',
                filterValue: brand,
                targetContainer: dom.faultList,
                debugEl: dom.step3Debug
            });

            updateStepStatus(2, 3);
            dom.step2.classList.add('hidden');
            dom.step3.classList.remove('hidden');
        }

        // 处理笔记本子分类选择（步骤2→步骤3）
        function handleLaptopSubtypeSelect(subtype) {
            globalData.selectedLaptopType = subtype;
            dom.step3Subtitle.textContent = `（笔记本 - ${subtype}）`;

            // 渲染故障列表：设备类型=笔记本 + 子分类=选中类型
            renderFaultList({
                deviceType: '笔记本',
                filterKey: 'laptopType',
                filterValue: subtype,
                targetContainer: dom.faultList,
                debugEl: dom.step3Debug
            });

            updateStepStatus(2, 3);
            dom.step2.classList.add('hidden');
            dom.step3.classList.remove('hidden');
        }

        // 渲染故障列表（通用核心函数，修复版）
        function renderFaultList(options) {
            const { deviceType, filterKey, filterValue, targetContainer, debugEl } = options;
            let faultData = [...globalData.repairData];

            // 核心过滤逻辑：先过滤设备类型，再过滤品牌/子分类（如果有）
            faultData = faultData.filter(item => {
                // 确保设备类型严格匹配
                const deviceMatch = item.deviceType === deviceType;
                // 如果有额外过滤条件，确保字段存在且匹配
                const filterMatch = filterKey ? (item[filterKey] === filterValue) : true;
                return deviceMatch && filterMatch;
            });

            // 调试信息（用户可查看当前过滤条件和结果数）
            let debugText = `设备类型：${deviceType}`;
            if (filterKey && filterValue) {
                debugText += ` | ${filterKey}：${filterValue}`;
            }
            debugText += ` | 匹配故障数：${faultData.length}`;
            debugEl.textContent = debugText;

            // 清空容器
            targetContainer.innerHTML = '';

            // 无故障数据提示
            if (faultData.length === 0) {
                targetContainer.innerHTML = `<div class="empty-tip col-span-full"><i class="fa-solid fa-info-circle mr-1"></i>暂无该分类的故障数据</div>`;
                return;
            }

            // 渲染故障项
            faultData.forEach(fault => {
                const item = document.createElement('div');
                item.className = 'bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition';
                item.innerHTML = `
                    <div class="flex items-start">
                        <i class="fa-solid fa-exclamation-triangle text-orange-500 mt-1 mr-3"></i>
                        <div>
                            <h3 class="font-medium">${fault.fault}</h3>
                            <p class="text-xs text-gray-500 mt-1">${fault.desc || '点击查看详细报价'}</p>
                        </div>
                    </div>
                `;
                item.addEventListener('click', () => handleFaultSelect(fault));
                targetContainer.appendChild(item);
            });
        }

        // 处理故障选择（步骤3→步骤4 或 步骤2→步骤3）
        function handleFaultSelect(fault) {
            globalData.selectedFault = fault;
            renderQuoteInfo(); // 渲染报价信息

            if (globalData.selectedDevice === '手机' || globalData.selectedDevice === '笔记本') {
                // 4步流程：故障→报价
                updateStepStatus(3, 4);
                dom.step3.classList.add('hidden');
                dom.step4.classList.remove('hidden');
            } else {
                // 3步流程：故障→报价（复用步骤3显示报价）
                updateStepStatus(2, 3);
                dom.step2.classList.add('hidden');
                dom.step3.classList.remove('hidden');
                // 切换步骤3为报价视图
                dom.step3Title.querySelector('span').textContent = '维修报价详情';
                dom.faultList.innerHTML = '';
                // 插入报价区域
                const quoteContainer = document.createElement('div');
                quoteContainer.innerHTML = `
                    <div class="border-b pb-4 mb-4">${dom.quoteInfo.innerHTML}</div>
                    <div class="quote-card bg-blue-50 rounded-lg p-4 mb-6">
                        <div class="text-center">
                            <p class="text-sm text-gray-600 mb-1">参考报价</p>
                            <p class="text-3xl font-bold text-blue-600">${dom.quotePrice.textContent}</p>
                            <p class="text-xs text-gray-500 mt-2">价格仅供参考，实际费用以检测后为准</p>
                        </div>
                    </div>
                `;
                dom.faultList.parentNode.replaceChild(quoteContainer, dom.faultList);
                // 隐藏返回按钮，显示预约按钮
                dom.backToStep2.style.display = 'none';
                const btnContainer = document.createElement('div');
                btnContainer.className = 'flex flex-col sm:flex-row gap-4';
                btnContainer.innerHTML = `
                    <button id="backToStep2Quote" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                        <i class="fa-solid fa-arrow-left mr-1"></i>重新选择
                    </button>
                    <a href="tel:4001234567" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center">
                        <i class="fa-solid fa-phone mr-2"></i>立即预约维修
                    </a>
                `;
                quoteContainer.parentNode.appendChild(btnContainer);
                // 绑定重新选择按钮事件
                btnContainer.querySelector('#backToStep2Quote').addEventListener('click', () => {
                    location.reload();
                });
            }
        }

        // 渲染报价信息
        function renderQuoteInfo() {
            const { selectedDevice, selectedBrand, selectedLaptopType, selectedFault } = globalData;
            let infoHtml = '';

            infoHtml += `<p class="text-sm text-gray-500">设备类型：<span class="text-gray-700 font-medium">${selectedDevice}</span></p>`;
            if (selectedBrand) {
                infoHtml += `<p class="text-sm text-gray-500">品牌：<span class="text-gray-700 font-medium">${selectedBrand}</span></p>`;
            }
            if (selectedLaptopType) {
                infoHtml += `<p class="text-sm text-gray-500">类型：<span class="text-gray-700 font-medium">${selectedLaptopType}</span></p>`;
            }
            infoHtml += `<p class="text-sm text-gray-500">故障类型：<span class="text-gray-700 font-medium">${selectedFault.fault}</span></p>`;

            dom.quoteInfo.innerHTML = infoHtml;
            dom.quotePrice.textContent = `¥${selectedFault.price}`;
        }

        // 更新步骤指示器状态
        function updateStepStatus(prevStep, currentStep) {
            // 重置所有步骤样式
            document.querySelectorAll('.step-item').forEach(item => {
                const step = item.dataset.step;
                const circle = item.querySelector('div');
                const text = item.querySelector('span');
                circle.className = 'w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold';
                text.className = 'mt-2 text-sm font-medium text-gray-500';
            });

            // 更新当前及之前步骤的样式
            for (let i = 1; i <= currentStep; i++) {
                const item = document.querySelector(`[data-step="${i}"]`);
                if (item) {
                    const circle = item.querySelector('div');
                    const text = item.querySelector('span');
                    circle.className = 'w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold';
                    text.className = 'mt-2 text-sm font-medium';
                }
            }

            // 更新进度条
            const progressBars = document.querySelectorAll('.step-progress, .step-progress-2, .step-progress-3');
            progressBars.forEach((bar, index) => {
                bar.style.width = (index + 1 < currentStep) ? '100%' : '0%';
            });
        }

        // 绑定返回按钮事件
        function bindBackEvents() {
            // 步骤2→步骤1
            dom.backToStep1.addEventListener('click', () => {
                updateStepStatus(2, 1);
                dom.step2.classList.add('hidden');
                dom.step1.classList.remove('hidden');
            });

            // 步骤3→步骤2
            dom.backToStep2.addEventListener('click', () => {
                updateStepStatus(3, 2);
                dom.step3.classList.add('hidden');
                dom.step2.classList.remove('hidden');
            });

            // 步骤4→步骤3
            dom.backToStep3.addEventListener('click', () => {
                updateStepStatus(4, 3);
                dom.step4.classList.add('hidden');
                dom.step3.classList.remove('hidden');
            });
        }
    </script>
</body>
</html>